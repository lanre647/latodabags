### Base URL
@baseUrl = http://localhost:5000/api/v1
@adminToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5NDI4NTg2OTE4OTA5NmZjNzQwZmM2ZCIsImVtYWlsIjoiYWRtaW5AbGF0b2JhZ3MuY29tIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNzY2MDUxNDc5LCJleHAiOjE3NjYwNTIzNzl9.f5xAXymPq8u84aUIb-11n9uyuz2lhNjtqmWFDATNJGY
@productId = 6943cf63dcd4779bbdf423c0
@userToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5NDIwYzJiYTYzNDkzNGEyODdmYWY2ZSIsImVtYWlsIjoidGVzdEBleGFtcGxlLmNvbSIsInJvbGUiOiJidXllciIsImlhdCI6MTc2NjA1MTg5NSwiZXhwIjoxNzY2MDUyNzk1fQ.d3IR9PYCUEeETVmyGxN14AnysNbNii4KYqZ09bp6meQ

@orderId = YOUR_ORDER_ID_HERE

### 1. Get All Products (Public)
GET {{baseUrl}}/products

### 2. Get Products with Filters (Public)
GET {{baseUrl}}/products?category=tote&limit=12&page=1

### 3. Get Products by Category (Public)
GET {{baseUrl}}/products?category=sling&featured=true

### 4. Search Products (Public)
GET {{baseUrl}}/products?search=leather&minPrice=1000&maxPrice=5000

### 5. Get Products with Pagination (Public)
GET {{baseUrl}}/products?page=2&limit=6&sort=-basePrice

### 6. Get Products by Category Route (Public)
GET {{baseUrl}}/products/category/tote?limit=10

### 7. Get Single Product (Public)
GET {{baseUrl}}/products/{{productId}}
### 7b. Get All Products Again (Public)
GET {{baseUrl}}/products
### 8. Create Product - Simple Tote (Admin Only)
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Modern Backpack",
  "basePrice": 17000,
  "images": [
    "https://res.cloudinary.com/demo/image/upload/sample1.jpg",
    "https://res.cloudinary.com/demo/image/upload/sample2.jpg"
  ],
  "description": "Handcrafted leather backpack perfect for everyday use. Made from premium Nigerian leather with reinforced stitching and spacious interior.",
  "category": "backpack",
  "featured": true
}

### 9. Create Product - Custom Sling with Options (Admin Only)
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Custom Crossbody Sling Bag",
  "basePrice": 12000,
  "images": [
    "https://res.cloudinary.com/demo/image/upload/sling1.jpg",
    "https://res.cloudinary.com/demo/image/upload/sling2.jpg",
    "https://res.cloudinary.com/demo/image/upload/sling3.jpg"
  ],
  "customOptions": [
    {
      "name": "size",
      "type": "select",
      "options": ["Small", "Medium", "Large"],
      "priceModifier": 0
    },
    {
      "name": "color",
      "type": "select",
      "options": ["Black", "Brown", "Tan", "Navy"],
      "priceModifier": 0
    },
    {
      "name": "strap_length",
      "type": "select",
      "options": ["Short (60cm)", "Medium (80cm)", "Long (100cm)"],
      "priceModifier": 500
    },
    {
      "name": "personalization",
      "type": "text",
      "priceModifier": 2000
    }
  ],
  "description": "Stylish crossbody sling bag with customizable options. Choose your preferred size, color, strap length, and add personalized text embroidery.",
  "category": "sling",
  "featured": false
}

### 10. Create Product - Clutch Bag (Admin Only)
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Evening Clutch Bag",
  "basePrice": 8500,
  "images": [
    "https://res.cloudinary.com/demo/image/upload/clutch1.jpg"
  ],
  "customOptions": [
    {
      "name": "material",
      "type": "select",
      "options": ["Leather", "Suede", "Satin"],
      "priceModifier": 1000
    }
  ],
  "description": "Elegant evening clutch perfect for special occasions. Compact design with secure magnetic closure.",
  "category": "clutch",
  "featured": false
}

### 11. Update Product (Admin Only)
PUT {{baseUrl}}/products/{{productId}}
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "basePrice": 16000,
  "featured": true,
  "description": "Updated description with more details about the craftsmanship and materials used."
}

### 12. Update Product - Add Custom Options (Admin Only)
PUT {{baseUrl}}/products/{{productId}}
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "customOptions": [
    {
      "name": "size",
      "type": "select",
      "options": ["S", "M", "L"],
      "priceModifier": 0
    },
    {
      "name": "initials",
      "type": "text",
      "priceModifier": 1500
    }
  ]
}

### 13. Delete Product (Admin Only)
DELETE {{baseUrl}}/products/{{productId}}
Authorization: Bearer {{adminToken}}

### 14. Test Validation - Missing Required Fields
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Test",
  "basePrice": 1000
}

### 15. Test Validation - Invalid Category
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Invalid Category Bag",
  "basePrice": 5000,
  "images": ["https://example.com/image.jpg"],
  "description": "This should fail due to invalid category",
  "category": "invalid_category"
}

### 16. Test Validation - Negative Price
POST {{baseUrl}}/products
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "name": "Negative Price Bag",
  "basePrice": -1000,
  "images": ["https://example.com/image.jpg"],
  "description": "This should fail due to negative price",
  "category": "tote"
}

### 17. Test Authorization - Create without Token (Should Fail)
POST {{baseUrl}}/products
Content-Type: application/json

{
  "name": "Unauthorized Bag",
  "basePrice": 5000,
  "images": ["https://example.com/image.jpg"],
  "description": "This should fail - no auth token",
  "category": "tote"
}

### 18. Test MongoDB Injection Protection
GET {{baseUrl}}/products?category[$ne]=tote

### 19. Get Featured Products Only
GET {{baseUrl}}/products?featured=true&limit=6

### 20. Sort Products by Price (Low to High)
GET {{baseUrl}}/products?sort=basePrice&limit=20

### 21. Create an Admin User (If not already created)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Admin User",
  "email": "admin@latobags.com",
  "password": "Admin123",
  "phone": "08012345678"
}

### 22. Login as Admin User to Get Token
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@latobags.com",
  "password": "Admin123"
}



## ---------------------------------------------------------------------

### 1. Create Custom Order - Simple (No Custom Options)
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {},
  "etaDays": 14,
  "shippingAddress": {
    "street": "123 Lekki Phase 1",
    "city": "Lagos",
    "state": "Lagos",
    "zipCode": "100001",
    "country": "Nigeria",
    "phone": "08012345678"
  },
  "notes": "Please use high-quality leather"
}

### 2. Create Custom Order - With Custom Specs
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {
    "size": "M",
    "color": "Brown",
    "strap_length": "Medium (80cm)",
    "personalization": "JD"
  },
  "etaDays": 21,
  "shippingAddress": {
    "street": "45 Victoria Island",
    "city": "Lagos",
    "state": "Lagos",
    "zipCode": "101001",
    "country": "Nigeria",
    "phone": "08098765432"
  },
  "notes": "Please embroider initials in gold thread"
}

### 3. Create Custom Order - Minimal (Uses user's saved address)
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {
    "size": "L"
  },
  "etaDays": 10
}

### 4. Get My Orders (User)
GET {{baseUrl}}/orders/my
Authorization: Bearer {{userToken}}

### 5. Get My Orders - Filtered by Status
GET {{baseUrl}}/orders/my?status=pending&page=1&limit=5
Authorization: Bearer {{userToken}}

### 6. Get My Orders - Sorted by Amount
GET {{baseUrl}}/orders/my?sort=-totalAmount
Authorization: Bearer {{userToken}}

### 7. Get Single Order (User)
GET {{baseUrl}}/orders/{{orderId}}
Authorization: Bearer {{userToken}}

### 8. Cancel Order (User - Only Pending Orders)
PUT {{baseUrl}}/orders/{{orderId}}/cancel
Authorization: Bearer {{userToken}}

### 9. Get All Orders (Admin)
GET {{baseUrl}}/orders/admin/all
Authorization: Bearer {{adminToken}}

### 10. Get All Orders - Filtered by Status (Admin)
GET {{baseUrl}}/orders/admin/all?status=crafting&page=1&limit=20
Authorization: Bearer {{adminToken}}

### 11. Get All Orders - Filtered by User (Admin)
GET {{baseUrl}}/orders/admin/all?userId=USER_ID_HERE
Authorization: Bearer {{adminToken}}

### 12. Update Order Status to Crafting (Admin)
PUT {{baseUrl}}/orders/admin/{{orderId}}/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "status": "crafting",
  "note": "Order confirmed. Starting production."
}

### 13. Update Order Status to Shipped (Admin)
PUT {{baseUrl}}/orders/admin/{{orderId}}/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "status": "shipped",
  "note": "Package shipped via courier. Tracking: ABC123XYZ"
}

### 14. Update Order Status to Delivered (Admin)
PUT {{baseUrl}}/orders/admin/{{orderId}}/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "status": "delivered",
  "note": "Successfully delivered to customer"
}

### 15. Test Validation - Missing Product ID
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "customSpecs": {},
  "etaDays": 14
}

### 16. Test Validation - Invalid Product ID Format
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "invalid-id",
  "customSpecs": {},
  "etaDays": 14
}

### 17. Test Validation - ETA Too High
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {},
  "etaDays": 100
}

### 18. Test Validation - Invalid Status Update (Admin)
PUT {{baseUrl}}/orders/admin/{{orderId}}/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "status": "invalid_status",
  "note": "This should fail"
}

### 19. Test Authorization - Create Order Without Token (Should Fail)
POST {{baseUrl}}/orders/custom
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {},
  "etaDays": 14
}

### 20. Test Authorization - Admin Route as User (Should Fail)
GET {{baseUrl}}/orders/admin/all
Authorization: Bearer {{userToken}}

### 21. Create Order with Invalid Custom Specs (Should Fail Validation)
POST {{baseUrl}}/orders/custom
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "productId": "{{productId}}",
  "customSpecs": {
    "size": "XXXL",
    "color": "InvalidColor"
  },
  "etaDays": 14
}

### 22. Get Order Statistics (Admin) - To be implemented
GET {{baseUrl}}/orders/admin/stats
Authorization: Bearer {{adminToken}}

## =====================================================================
## PAYMENT ENDPOINTS - Paystack Integration
## =====================================================================

### Payment: 1. Payment Service Health Check
GET {{baseUrl}}/payment/health

### Payment: 2. Initialize Payment (Required for any order)
POST {{baseUrl}}/payment/initialize
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "orderId": "507f1f77bcf86cd799439011",
  "amount": 15000
}

### Payment: 3. Verify Payment Transaction
POST {{baseUrl}}/payment/verify/your-transaction-reference-here
Authorization: Bearer {{userToken}}
Content-Type: application/json

### Payment: 4. Test Payment Initialization - Invalid Order ID
POST {{baseUrl}}/payment/initialize
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "orderId": "invalid-id",
  "amount": 15000
}

### Payment: 5. Test Payment Initialization - Negative Amount
POST {{baseUrl}}/payment/initialize
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "orderId": "507f1f77bcf86cd799439011",
  "amount": -5000
}

### Payment: 6. Test Payment Initialization - Amount Too High
POST {{baseUrl}}/payment/initialize
Authorization: Bearer {{userToken}}
Content-Type: application/json

{
  "orderId": "507f1f77bcf86cd799439011",
  "amount": 600000
}

### Payment: 7. Test Payment Verification - Invalid Reference
POST {{baseUrl}}/payment/verify/invalid-ref
Authorization: Bearer {{userToken}}
Content-Type: application/json

### Payment: 8. Payment Initialization Without Auth (Should Fail)
POST {{baseUrl}}/payment/initialize
Content-Type: application/json

{
  "orderId": "507f1f77bcf86cd799439011",
  "amount": 15000
}

### Payment: 9. Simulate Paystack Webhook - Successful Charge
POST {{baseUrl}}/payment/webhook
Content-Type: application/json
X-Paystack-Signature: your-signature-here

{
  "event": "charge.success",
  "data": {
    "id": 1234567890,
    "reference": "ref-12345",
    "amount": 1500000,
    "paid_at": "2025-12-18T10:30:00Z",
    "status": "success",
    "customer": {
      "id": 1,
      "email": "customer@test.com",
      "customer_code": "CUS_abc123"
    },
    "authorization": {
      "authorization_code": "AUTH_xyz789",
      "bin": "412345",
      "last4": "5678",
      "exp_month": "12",
      "exp_year": "25",
      "channel": "card",
      "card_type": "visa",
      "bank": "Test Bank",
      "country_code": "NG",
      "brand": "visa",
      "should_reauthorize": false
    },
    "metadata": {
      "orderId": "507f1f77bcf86cd799439011"
    }
  }
}

### Payment: 10. Simulate Paystack Webhook - Failed Charge
POST {{baseUrl}}/payment/webhook
Content-Type: application/json
X-Paystack-Signature: your-signature-here

{
  "event": "charge.failed",
  "data": {
    "id": 1234567891,
    "reference": "ref-12346",
    "amount": 1500000,
    "status": "failed",
    "gateway_response": "Insufficient funds",
    "customer": {
      "id": 2,
      "email": "customer2@test.com"
    }
  }
}